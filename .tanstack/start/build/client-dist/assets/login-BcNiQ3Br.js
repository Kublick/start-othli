import{R as N,r as J,u as M,j as i,c as B,L as I,B as L}from"./main-B73lRcC6.js";import{c as H,a as z,u as W,b as V,F as $,d as T,e as O,f as k,g as A,I as C,h as R,o as X,s as K,t as q,i as F}from"./auth-client-DGMqDV8x.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M7 2h10",key:"nczekb"}],["path",{d:"M5 6h14",key:"u2x4p"}],["rect",{width:"18",height:"12",x:"3",y:"10",rx:"2",key:"l0tzu3"}]],Y=H("GalleryVerticalEnd",Q),U=n=>{let t;const e=new Set,r=(h,l)=>{const y=typeof h=="function"?h(t):h;if(!Object.is(y,t)){const v=t;t=l??(typeof y!="object"||y===null)?y:Object.assign({},t,y),e.forEach(m=>m(t,v))}},o=()=>t,c={setState:r,getState:o,getInitialState:()=>f,subscribe:h=>(e.add(h),()=>e.delete(h))},f=t=n(r,o,c);return c},Z=n=>n?U(n):U,ee=n=>n;function te(n,t=ee){const e=N.useSyncExternalStore(n.subscribe,()=>t(n.getState()),()=>t(n.getInitialState()));return N.useDebugValue(e),e}const D=n=>{const t=Z(n),e=r=>te(t,r);return Object.assign(e,t),e},ne=n=>n?D(n):D,P={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,TSS_APP_BASE:"/",TSS_OUTPUT_PUBLIC_DIR:"/Users/maxb/Developer/sandbox/coolify-test/othli/couples2/.output/public",TSS_SERVER_FN_BASE:"/_serverFn",VITE_BETTER_AUTH_URL:"http://localhost:3000"},j=new Map,_=n=>{const t=j.get(n);return t?Object.fromEntries(Object.entries(t.stores).map(([e,r])=>[e,r.getState()])):{}},oe=(n,t,e)=>{if(n===void 0)return{type:"untracked",connection:t.connect(e)};const r=j.get(e.name);if(r)return{type:"tracked",store:n,...r};const o={connection:t.connect(e),stores:{}};return j.set(e.name,o),{type:"tracked",store:n,...o}},re=(n,t)=>{if(t===void 0)return;const e=j.get(n);e&&(delete e.stores[t],Object.keys(e.stores).length===0&&j.delete(n))},se=n=>{var t,e;if(!n)return;const r=n.split(`
`),o=r.findIndex(p=>p.includes("api.setState"));if(o<0)return;const a=((t=r[o+1])==null?void 0:t.trim())||"";return(e=/.+ (.+) .+/.exec(a))==null?void 0:e[1]},ie=(n,t={})=>(e,r,o)=>{const{enabled:a,anonymousActionType:p,store:c,...f}=t;let h;try{h=(a??(P?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!h)return n(e,r,o);const{connection:l,...y}=oe(c,h,f);let v=!0;o.setState=(s,g,d)=>{const u=e(s,g);if(!v)return u;const S=se(new Error().stack),b=d===void 0?{type:p||S||"anonymous"}:typeof d=="string"?{type:d}:d;return c===void 0?(l==null||l.send(b,r()),u):(l==null||l.send({...b,type:`${c}/${b.type}`},{..._(f.name),[c]:o.getState()}),u)},o.devtools={cleanup:()=>{l&&typeof l.unsubscribe=="function"&&l.unsubscribe(),re(f.name,c)}};const m=(...s)=>{const g=v;v=!1,e(...s),v=g},x=n(o.setState,r,o);if(y.type==="untracked"?l==null||l.init(x):(y.stores[y.store]=o,l==null||l.init(Object.fromEntries(Object.entries(y.stores).map(([s,g])=>[s,s===y.store?x:g.getState()])))),o.dispatchFromDevtools&&typeof o.dispatch=="function"){let s=!1;const g=o.dispatch;o.dispatch=(...d)=>{(P?"production":void 0)!=="production"&&d[0].type==="__setState"&&!s&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),s=!0),g(...d)}}return l.subscribe(s=>{var g;switch(s.type){case"ACTION":if(typeof s.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return w(s.payload,d=>{if(d.type==="__setState"){if(c===void 0){m(d.state);return}Object.keys(d.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const u=d.state[c];if(u==null)return;JSON.stringify(o.getState())!==JSON.stringify(u)&&m(u);return}o.dispatchFromDevtools&&typeof o.dispatch=="function"&&o.dispatch(d)});case"DISPATCH":switch(s.payload.type){case"RESET":return m(x),c===void 0?l==null?void 0:l.init(o.getState()):l==null?void 0:l.init(_(f.name));case"COMMIT":if(c===void 0){l==null||l.init(o.getState());return}return l==null?void 0:l.init(_(f.name));case"ROLLBACK":return w(s.state,d=>{if(c===void 0){m(d),l==null||l.init(o.getState());return}m(d[c]),l==null||l.init(_(f.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return w(s.state,d=>{if(c===void 0){m(d);return}JSON.stringify(o.getState())!==JSON.stringify(d[c])&&m(d[c])});case"IMPORT_STATE":{const{nextLiftedState:d}=s.payload,u=(g=d.computedStates.slice(-1)[0])==null?void 0:g.state;if(!u)return;m(c===void 0?u:u[c]),l==null||l.send(null,d);return}case"PAUSE_RECORDING":return v=!v}return}}),x},ae=ie,w=(n,t)=>{let e;try{e=JSON.parse(n)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}e!==void 0&&t(e)};function le(n,t){let e;try{e=n()}catch{return}return{getItem:o=>{var a;const p=f=>f===null?null:JSON.parse(f,void 0),c=(a=e.getItem(o))!=null?a:null;return c instanceof Promise?c.then(p):p(c)},setItem:(o,a)=>e.setItem(o,JSON.stringify(a,void 0)),removeItem:o=>e.removeItem(o)}}const E=n=>t=>{try{const e=n(t);return e instanceof Promise?e:{then(r){return E(r)(e)},catch(r){return this}}}catch(e){return{then(r){return this},catch(r){return E(r)(e)}}}},ce=(n,t)=>(e,r,o)=>{let a={storage:le(()=>localStorage),partialize:s=>s,version:0,merge:(s,g)=>({...g,...s}),...t},p=!1;const c=new Set,f=new Set;let h=a.storage;if(!h)return n((...s)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),e(...s)},r,o);const l=()=>{const s=a.partialize({...r()});return h.setItem(a.name,{state:s,version:a.version})},y=o.setState;o.setState=(s,g)=>{y(s,g),l()};const v=n((...s)=>{e(...s),l()},r,o);o.getInitialState=()=>v;let m;const x=()=>{var s,g;if(!h)return;p=!1,c.forEach(u=>{var S;return u((S=r())!=null?S:v)});const d=((g=a.onRehydrateStorage)==null?void 0:g.call(a,(s=r())!=null?s:v))||void 0;return E(h.getItem.bind(h))(a.name).then(u=>{if(u)if(typeof u.version=="number"&&u.version!==a.version){if(a.migrate){const S=a.migrate(u.state,u.version);return S instanceof Promise?S.then(b=>[!0,b]):[!0,S]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,u.state];return[!1,void 0]}).then(u=>{var S;const[b,G]=u;if(m=a.merge(G,(S=r())!=null?S:v),e(m,!0),b)return l()}).then(()=>{d==null||d(m,void 0),m=r(),p=!0,f.forEach(u=>u(m))}).catch(u=>{d==null||d(void 0,u)})};return o.persist={setOptions:s=>{a={...a,...s},s.storage&&(h=s.storage)},clearStorage:()=>{h==null||h.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>x(),hasHydrated:()=>p,onHydrate:s=>(c.add(s),()=>{c.delete(s)}),onFinishHydration:s=>(f.add(s),()=>{f.delete(s)})},a.skipHydration||x(),m||v},de=ce,ue=ne(de(ae(n=>({isAuthenticated:!1,user:null,isLoading:!1,error:null,setUser:t=>n({user:t,isAuthenticated:!!t},void 0,"setUser"),setError:t=>n({error:t},void 0,"setError"),setLoading:t=>n({isLoading:t},void 0,"setLoading"),login:async(t,e)=>{n({isLoading:!0,error:null},void 0,"login");try{const r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:e})});if(!r.ok)throw new Error("Login failed");const o=await r.json();n({user:o,isAuthenticated:!0,isLoading:!1},void 0,"login-success")}catch(r){throw n({error:r instanceof Error?r.message:"Authentication failed",isLoading:!1},void 0,"Auth-failed"),r}},loginWithGoogle:async()=>{n({isLoading:!0,error:null},void 0,"loginWithGoogle");try{window.location.href="/api/auth/google"}catch(t){throw n({error:t instanceof Error?t.message:"Google authentication failed",isLoading:!1},void 0,"loginWithGoogle-failed"),t}},logout:async()=>{n({isLoading:!0,error:null},void 0,"logout");try{await fetch("/api/auth/logout",{method:"POST"}),n({user:null,isAuthenticated:!1,isLoading:!1},void 0,"logout-success")}catch(t){throw n({error:t instanceof Error?t.message:"Logout failed",isLoading:!1},void 0,"logout-failed"),t}},checkAuth:async()=>{var t;n({isLoading:!0},void 0,"checkAuth-loading");try{const e=await z.getSession();(t=e==null?void 0:e.data)!=null&&t.user?n({user:{id:e.data.user.id,email:e.data.user.email,name:e.data.user.name,image:e.data.user.image||void 0},isAuthenticated:!0,isLoading:!1},void 0,"checkAuth-authenticated"):n({user:null,isAuthenticated:!1,isLoading:!1},void 0,"checkAuth-unauthenticated")}catch(e){n({user:null,isAuthenticated:!1,isLoading:!1,error:e instanceof Error?e.message:"Failed to verify authentication"},void 0,"checkAuth")}}}),{name:"auth-storage"}),{name:"auth-store"})),fe=X({email:F().email({message:"Email es obligatorio"}),password:F().min(8,{message:"Contraseña es obligatoria de 8 caracteres"})}),he=()=>{const{login:n,loginWithGoogle:t}=ue(),e=J.useCallback(async()=>{await t()},[t]);M();const r=W({resolver:V(fe),defaultValues:{email:"",password:""}}),o=async a=>{const{email:p,password:c}=a;try{const f=await K.email({email:p,password:c});console.log(f)}catch(f){console.log(f),q.error("Error en las credenciales")}};return i.jsx($,{...r,children:i.jsxs("form",{onSubmit:r.handleSubmit(o),className:B("flex flex-col gap-6"),children:[i.jsx("div",{className:"flex flex-col items-center gap-2 text-center",children:i.jsx("h1",{className:"font-bold text-2xl",children:"Ingresa a tu cuenta"})}),i.jsxs("div",{className:"grid gap-6",children:[i.jsx(T,{control:r.control,name:"email",render:({field:a})=>i.jsxs(O,{children:[i.jsx(k,{children:"Email"}),i.jsx(A,{children:i.jsx(C,{placeholder:"email@email.com",...a})}),i.jsx(R,{})]})}),i.jsx(T,{control:r.control,name:"password",render:({field:a})=>i.jsxs(O,{children:[i.jsx(k,{children:"Contraseña"}),i.jsx(A,{children:i.jsx(C,{placeholder:"*****",...a,type:"password"})}),i.jsx(R,{})]})}),i.jsx("div",{className:"grid gap-2",children:i.jsx("div",{className:"flex items-center",children:i.jsx(I,{to:"/auth/forgot",className:"ml-auto text-sm underline-offset-4 hover:underline",children:"¿Olvidaste tu contraseña?"})})}),i.jsx(L,{type:"submit",className:"w-full",children:"Ingresar"}),i.jsx("div",{className:"relative text-center text-sm after:absolute after:inset-0 after:top-1/2 after:z-0 after:flex after:items-center after:border-border after:border-t",children:i.jsx("span",{className:"relative z-10 bg-background px-2 text-muted-foreground",children:"o continua con"})}),i.jsxs(L,{type:"button",variant:"outline",className:"w-full",onClick:e,children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-label":"Google logo",children:[i.jsx("title",{children:"Google"}),i.jsx("path",{d:"M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .307 5.387.307 12s5.56 12 12.173 12c3.573 0 6.267-1.173 8.373-3.36 2.16-2.16 2.84-5.213 2.84-7.667 0-.76-.053-1.467-.173-2.053H12.48z",fill:"currentColor"})]}),"Login with Google"]})]}),i.jsxs("div",{className:"text-center text-sm",children:["No tienes cuenta"," ",i.jsx(I,{to:"/auth/signup",className:"underline underline-offset-4",children:"Registrate"})]})]})})},ve=function(){return i.jsxs("div",{className:"grid min-h-svh lg:grid-cols-2",children:[i.jsxs("div",{className:"flex flex-col gap-4 p-6 md:p-10",children:[i.jsx("div",{className:"flex justify-center gap-2 md:justify-start",children:i.jsxs("a",{href:"/",className:"flex items-center gap-2 font-medium",children:[i.jsx("div",{className:"flex h-6 w-6 items-center justify-center rounded-md bg-primary text-primary-foreground",children:i.jsx(Y,{className:"size-4"})}),"OhtliFin"]})}),i.jsx("div",{className:"flex flex-1 items-center justify-center",children:i.jsx("div",{className:"w-full max-w-xs",children:i.jsx(he,{})})})]}),i.jsx("div",{className:"relative hidden bg-muted lg:block",children:i.jsx("img",{src:"https://placehold.co/200x200",alt:"something",className:"absolute inset-0 h-full w-full object-cover dark:brightness-[0.2] dark:grayscale"})})]})};export{ve as component};
